<!DOCTYPE HTML>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@tim_hosgood">
    <meta name="twitter:title" content="Weighted limits, ends, and Day convolution // Tim Hosgood">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://thosgood.com/assets/images/me.jpg">

    <title>Tim Hosgood | Weighted limits, ends, and Day convolution</title>

    <link rel="stylesheet" href="/assets/css/global.css">
    <link rel="stylesheet" href="/assets/css/blog.css">
    <link rel="stylesheet" href="/assets/css/post.css">
    <link rel="stylesheet" href="/assets/css/citations.css">

    <link rel="stylesheet" href="/assets/css/tachyons.css">
    <link rel="stylesheet" href="/assets/katex/katex.min.css">
</head>

  <body>

    <div id="header-wrapper" class="h3-ns w-100 flex items-center justify-center">
  <div id="header" class="w-60-ns w-80-m flex flex-wrap items-center">
    <div class="w-third-ns tl pb0-ns pb2 w-100">
      <span class="f4-ns f5"><a class="link" href="/">Tim Hosgood</a></span>
    </div>
    <div id="nav_bar" class="w-two-thirds-ns tr w-100">
      <ol class="fr-ns list ma0 pl0">
        <li class="ph2-ns ph1 dib">
          <a class="link f4-ns f5" href="/work/">Work</a>
        </li>
        <li class="ph2-ns ph1 dib">
          <a class="link f4-ns f5" href="/translations/">Translations</a>
        </li>
        <li class="ph2-ns ph1 dib">
          <a class="link f4-ns f5" href="/blog/">Blog</a>
        </li>
        <li class="pl2-ns pl1 dib">
          <a class="link f4-ns f5" href="/cv/">CV</a>
        </li>
      </ol>
    </div>
  </div>
</div>

    <div class="mw7 flex flex-column center">
      <div id="main" class="w-100 flex flex-wrap items-start lh-title mv3 ph4">
        
  <div id="post-nav" class="w-80-ns w-100">
    <ul id="colour-select" class="fl">
      <li>
        <button type="button" onclick="lightStyle()">
          Light
        </button>
      </li>
      <li>
        <button type="button" onclick="darkStyle()">
          Dark
        </button>
      </li>
    </ul>
    <ul id="font-select" class="fl">
      <li>
        <button type="button" onclick="sansStyle()">
          Sans
        </button>
      </li>
      <li>
        <button type="button" onclick="serifStyle()">
          Serif
        </button>
      </li>
    </ul>
    <a href="/blog/#2019-09-05-day-convolution-part-3" class="fr f5">← Return to all posts</a>
  </div>
  <div id="post-content" class="w-80-ns ph3-ns w-100">
    <h1 id="post-title">Weighted limits, ends, and Day convolution</h1>
    <h2 id="post-part">Part 3</h2>
    <h6 id="post-date">5th September, 2019</h6>
    <div class="tag-list">
      <a href="/blog/tags/category-theory" rel="tag">category-theory</a>, <a href="/blog/tags/profunctors" rel="tag">profunctors</a>
    </div>
    
      <div id="post-other-parts" class="mt3">
        <span class="i">See all parts of this series:</span>
        
          
            <a href="/blog/2017/12/08/day-convolution-part-1.html">Part 1</a>
          
        
          
        
          
        
          
            <a href="/blog/2018/02/15/day-convolution-part-2.html">Part 2</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <span class="active">Part 3</span>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    

    <ol id="toc">
<li><a href="#tensor-products">Tensor products</a></li>
<li><a href="#day-convolution">Day convolution</a></li>
<li><a href="#profunctors">Profunctors</a></li>
</ol>
<p>Finally, I find myself with enough motivation to start writing the last part to this series. It’s been a while, but hopefully nobody has actually been waiting… This is where we will finally see some of the exciting applications of (co)ends, including tensor products, geometric realisation, and Day convolution. One reason I’ve got around to writing this post is because coends (or, really, cowedges) appeared to me recently in a tweet about Stokes’ theorem, which I found pretty neat indeed — more details can be found in <a href="/blog/2019/09/04/stokes-coend.html">this post</a>.</p>
<!-- more -->
<p>For a refresher on all the definitions, you can check out the two previous parts in this series, because we’re just going to dive right in.</p>
<h1 id="tensor-products">Tensor products</h1>
<a href="#post-title" class="toc-back">↟</a>
<p>Let <span class="math inline">F\colon\mathcal{C}^\mathrm{op}\to\mathcal{D}</span> and <span class="math inline">G\colon\mathcal{C}\to\mathcal{D}</span> be <span class="math inline">\mathcal{V}</span>-functors. Then we define their <em>tensor product</em> to be, <strong>if it exists</strong>, the coend</p>
<p><span class="math display">F\otimes_\mathcal{C}G = \int^{c\in\mathcal{C}}F(c)\otimes G(c).</span></p>
<p>As before, we have a non-enriched definition: whenever <span class="math inline">\mathcal{D}</span> has <strong>all coproducts</strong>, we can define</p>
<p><span class="math display">F\otimes_\mathcal{C}G = \int^{c\in\mathcal{C}}F(c)\cdot G(c)</span></p>
<p>where <span class="math inline">S\cdot d=\coprod_{s\in S}d</span> for any set <span class="math inline">S</span> and any object <span class="math inline">d\in D</span>.</p>
<h2 id="examples">Examples</h2>
<ul>
<li>
<p>Consider a ring <span class="math inline">R</span> as a one-object <span class="math inline">\mathsf{Ab}</span>-enriched. Then a right <span class="math inline">R</span>-module gives an additive functor <span class="math inline">R^\mathrm{op}\to\mathsf{Ab}</span>, and a left <span class="math inline">R</span>-module gives an additive functor <span class="math inline">R\to\mathsf{Ab}</span>. Then their tensor product, as <span class="math inline">\mathsf{Ab}</span>-enriched functors, coincides with their usual tensor product as <span class="math inline">R</span>-modules.</p>
<p>This example is actually really linked to the theory of <em>profunctors</em>, which we will talk about below, but have already talked about in <a href="https://thosgood.com/blog/2019/07/14/cauchy-completion-and-profunctors.html">a previous post</a>.</p>
</li>
<li>
<p>The co-Yoneda lemma <span class="math inline">F \cong \int^{c\in\mathcal{C}} \mathcal{C}(-,c)\otimes F(c)</span> can now just be written as</p>
<p><span class="math display">F\cong F\otimes_\mathcal{C}よ</span></p>
<p>where <span class="math inline">よ\colon\mathcal{C}\to\widehat{\mathcal{C}}</span> is the Yoneda embedding.</p>
<p>This lets us state the powerful adage, that “representable functors generalise free modules”. To see what this might mean, we state the co-Yoneda lemma applied to a representable functor, as well as a basic theorem about tensor products of free modules, and leave the drawing of connections between the two to the interested reader:</p>
<p><span class="math display">\begin{aligned}
      \operatorname{Hom}_\mathcal{C}(-,c)\otimes_\mathcal{C}F &amp;\cong F(c)\\
      R^n\otimes_R M &amp;\cong M^n.
  \end{aligned}</span></p>
</li>
<li>
<p>Geometric realisation of a simplicial set <span class="math inline">X</span> can also be expressed as a tensor product. If we write</p>
<p><span class="math display">\vert-\vert\colon\Delta\to\mathsf{Top}</span></p>
<p>to mean the functor that sends <span class="math inline">[n]</span> to the topological <span class="math inline">n</span>-simplex, then we can write the geometric realisation <span class="math inline">\vert X\vert</span> of <span class="math inline">X</span> as</p>
<p><span class="math display">\vert X\vert\cong X\otimes_\Delta\vert-\vert.</span></p>
</li>
</ul>
<h1 id="day-convolution">Day convolution</h1>
<a href="#post-title" class="toc-back">↟</a>
<p>As a motivation for the definition of Day convolution, we first recall the classical notion of convolution (albeit phrased in a more categorical language). Consider <span class="math inline">\mathbb{N}</span> as a <strong>discrete</strong> category with addition as a monoidal product. Let <span class="math inline">F,G\colon\mathbb{N}\to\mathsf{Set}</span> be functors, which we can think of as <em>graded sets</em>. Then their <em>convolution</em> <span class="math inline">(F*G)\colon\mathbb{N}\to\mathsf{Set}</span> is defined by</p>
<p><span class="math display">\begin{aligned}
&amp;(F*G)(n) = \sum_{i+j=n} F(i)\otimes G(j)\\
&amp;= \sum_{i,j=1}^n F(i)\otimes G(j)\otimes\operatorname{Hom}_\mathbb{N}(n,i+j)
\end{aligned}</span></p>
<p>where the second equality follows from the fact that <span class="math inline">\mathbb{N}</span> is discrete. It might seem like an excessively abstract way of writing some Kronecker delta function, but it is exactly the thing that makes this definition easy to abstractify and generalise.</p>
<p>So now let <span class="math inline">F,G\in\widehat{\mathcal{C}}=[\mathcal{C}^\mathrm{op},\mathcal{V}]=\mathsf{PrSh}_\mathcal{V}(\mathcal{C})</span> (or whichever other notation you most like that says that <span class="math inline">F</span> and <span class="math inline">G</span> are <span class="math inline">\mathcal{V}</span>-valued presheaves). Then we define their <em>Day convolution</em> <span class="math inline">(F*G)\in\widehat{\mathcal{C}}</span> by</p>
<p><span class="math display">(F*G)(c) = \int^{x,x'\in\mathcal{C}} F(x)\otimes G(x')\otimes\operatorname{Hom}_\mathcal{C}(c,x\otimes x')</span></p>
<p>or, if you <em>really</em> like tensor-product notation more than coend notation, by</p>
<p><span class="math display">(F*G)(c) = (F\otimes G)\otimes_{\mathcal{C}\times\mathcal{C}}\operatorname{Hom}_\mathcal{C}(c,-\otimes-).</span></p>
<p>As I already mentioned in my <a href="%7B%7B%20site.baseurl%20%7D%7D%7B%%20post_url%202019-07-14-cauchy-completion-and-profunctors%20%%7D">post about profunctors</a>, there is a notion of Cauchy completion for presheaves. Something that I often heard say is that the presheaf category <em>itself</em> is the ‘free cocompletion’ of the original category. There are a bunch of ways of explaining what this means, but my favourite ‘proof’ is using Day convolution and the co-Yoneda lemma, to show that the Yoneda embedding <span class="math inline">よ\colon\mathcal{C}\to\widehat{\mathcal{C}}</span> is <strong>monoidal</strong>:</p>
<p><span class="math display">\begin{gathered}
    \big( \operatorname{Hom}_\mathcal{C}(-,x)*\operatorname{Hom}_\mathcal{C}(-,x') \big)(c)\\
    \cong \int^{y,y'\in\mathcal{C}}\operatorname{Hom}_\mathcal{C}(y,x)\otimes\operatorname{Hom}_\mathcal{C}(y',x')\otimes\operatorname{Hom}_\mathcal{C}(c,y\otimes y')\\
    \cong \int^{y\in\mathcal{C}}\operatorname{Hom}_\mathcal{C}(y,x)\otimes\operatorname{Hom}_\mathcal{C}(c,y\otimes x')\\
    \cong \operatorname{Hom}_\mathcal{C}(c,x\otimes x')
\end{gathered}</span></p>
<p>where the first isomorphism is by definition, and the last two are by co-Yoneda. That is,</p>
<p><span class="math display">\operatorname{Hom}_\mathcal{C}(-,x)*\operatorname{Hom}_\mathcal{C}(-,x') \cong \operatorname{Hom}_\mathcal{C}(-,x\otimes x').</span></p>
<p>That is, <em>the Yoneda embedding is a (strong) monoidal functor</em></p>
<p><span class="math display">(\mathcal{C},\otimes_\mathcal{C},I)\hookrightarrow(\widehat{\mathcal{C}},*,よ(I)).</span></p>
<p>Further, if <span class="math inline">\mathcal{C}</span> is small, then there is an internal hom on <span class="math inline">\widehat{\mathcal{C}}</span> which makes it <em>closed</em>.</p>
<p>Finally, as a fun little fact, which I used at some point in one of my masters theses,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> whenever <span class="math inline">\mathcal{C}</span> is small and symmetric, (commutative) monoid objects in the enriched-presheaf category (with Day convolution) are equivalent to (symmetric) lax monoidal functors from <span class="math inline">\mathcal{C}</span> to <span class="math inline">\mathcal{V}</span>.</p>
<h2 id="monoid-algebra">Monoid algebra</h2>
<p>Remembering all that we’ve said above about free modules, and how Day convolution is basically the presheaf version of the tensor product from the original category, I would like to repeat some of what <a href="http://web.science.mq.edu.au/~alexc/">Alexander Campbell</a> wrote in response to a <a href="https://math.stackexchange.com/questions/1650786/day-convolution-intuition">question I asked about Day convolution</a> during the writing of my masters thesis.</p>
<p>There is a beautiful formal analogy between Day convolution and monoid algebra, which takes the following form:</p>
<table>
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>monoid algebra</th>
<th>Day convolution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>set</td>
<td>category</td>
</tr>
<tr class="even">
<td>monoid</td>
<td>monoidal category</td>
</tr>
<tr class="odd">
<td>ring <span class="math inline">R</span>
</td>
<td>monoidally cocomplete category</td>
</tr>
<tr class="even">
<td>
<span class="math inline">R</span>-module</td>
<td>cocomplete <span class="math inline">\mathcal{V}</span>-category</td>
</tr>
<tr class="odd">
<td>
<span class="math inline">R</span>-algebra</td>
<td>monoidally cocomplete <span class="math inline">\mathcal{V}</span>-category</td>
</tr>
<tr class="even">
<td>free <span class="math inline">R</span>-module <span class="math inline">R^{(X)}</span> on a set <span class="math inline">X</span>
</td>
<td>free cocomplete <span class="math inline">\mathcal{V}</span>-category <span class="math inline">\widehat{\mathcal{C}}</span> on a category <span class="math inline">\mathcal{C}</span>
</td>
</tr>
<tr class="odd">
<td>free <span class="math inline">R</span>-module <span class="math inline">R^{(X)}</span> on a monoid <span class="math inline">M</span> with the convolution product</td>
<td>free monoidally cocomplete <span class="math inline">\mathcal{V}</span>-category <span class="math inline">\widehat{\mathcal{A}}</span> on a monoidal category <span class="math inline">\mathcal{A}</span> with Day convolution</td>
</tr>
</tbody>
</table>
<p>where a <em>monoidally cocomplete</em> category is a cocomplete monoidal category <span class="math inline">\mathcal{V}</span> such that <span class="math inline">(-\otimes-)\colon\mathcal{V}\times\mathcal{V}\to\mathcal{V}</span> is cocontinuous in each variable.</p>
<h1 id="profunctors">Profunctors</h1>
<a href="#post-title" class="toc-back">↟</a>
<p>Just to have my obligatory “here is something that I don’t understand” that all of my posts seem to have, I wrote down in my notes (only a few weeks ago) the following sentence:</p>
<p><em>“profunctors! composition is via coends, and this looks like ∃ for composition of relations”</em></p>
<p>I have a vague idea of what this means: when we compose relations we do it ‘by existence’, in that</p>
<p><span class="math display">\begin{gathered}
SR(x,y)\\
\iff\\
\exists t\text{ s.t. }R(x,t)\wedge S(t,y)
\end{gathered}</span></p>
<p>and this somehow looks like a coend, but I have no idea (nor, really, the time (nor, really, the skill) to properly think about) how to make this formal. Any ideas?</p>
<p><strong>Edit.</strong> As always, I asked the lovely people of Twitter whether they could shed any light on what I meant here. As always, I got some great replies:</p>
<p><img src="/assets/post-images/2019-09-05-day-convolution-part-3-sclv.png" alt="sclv"> <img src="/assets/post-images/2019-09-05-day-convolution-part-3-emi1ypi.png" alt="emi1ypi"></p>
<p>(the article linked to is <a href="https://bartoszmilewski.com/2019/03/27/promonads-arrows-and-einstein-notation-for-profunctors/">this one</a>, and it is, indeed, great.)</p>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p>§4.1 in <a href="https://github.com/thosgood/papers/blob/master/under-spec-z-readers-companion/under-spec-z.pdf">Under Spec Z. A reader’s companion.</a>. It’s actually something that I’d love to come back to at some point!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>


  </div>

      </div>
    </div>
    <div id="footer-wrapper" class="h3-ns w-100 flex items-center justify-center">
  <div id="footer" class="w-60-ns w-80-m pa3 flex flex-wrap items-center f6">
    
    <div class="w-third-ns tl w-100">
      <ul class="list pl0 ma0">
        <!-- <li>Tim Hosgood</li> -->
        <!-- <li>Stockholms Universitet</li> -->
        <li><a href="mailto:tim.hosgood@posteo.net">tim.hosgood@posteo.net</a></li>
      </ul>
    </div>
    
    <div class="w-two-thirds-ns tr w-100">
      <ul class="ma0-ns fr-ns list ph0 mt3">
        <li class="ph2 di"><a href="https://twitter.com/tim_hosgood">Twitter</a></li>
        <li class="ph2 di"><a href="https://github.com/thosgood">GitHub</a></li>
        <li class="ph2 di"><a href="https://matrix.to/#/@thosgood:matrix.org">Element</a></li>
        <li class="pl2 di"><a href="https://arxiv.org/a/hosgood_t_1">arXiv</a></li>
      </ul>
    </div>

  </div>
</div>

    
      <script type="text/javascript" src="/assets/jquery-3.4.1.slim.min.js"></script>

<script type="text/javascript" src="/assets/katex/katex.min.js"></script>
<script type="text/javascript">
$("span[class='math inline']").replaceWith(
  function(){
    var tex = $(this).text();
    return "<span class=\"inline-equation\">" + 
           katex.renderToString(tex, {throwOnError: false}) +
           "</span>";
});

$("span[class='math display']").replaceWith(
  function(){
    var tex = $(this).text();
    return "<div class=\"equation\">" + 
           katex.renderToString(tex, {displayMode: true, fleqn: true, throwOnError: false}) +
           "</div>";
});
</script>

    

  </body>
</html><html><script type="text/javascript">
  const body = document.getElementsByTagName('body')[0];
  const content = document.getElementById('post-content');

  function lightStyle() {
    body.style.background = '#f0f8ff';
    body.style.color = 'black';
    document.getElementById('post-nav').style.background = '#eee'
    var links = document.getElementsByTagName('a');
    for (var i = 0; i < links.length; i++) {
      links[i].style.color = '#2a7ae2';
    }
  }
  function darkStyle() {
    body.style.background = '#333';
    body.style.color = '#eee';
    document.getElementById('post-nav').style.background = '#555'
    var links = document.getElementsByTagName('a');
    for (var i = 0; i < links.length; i++) {
      links[i].style.color = '#82b2ee';
    }
    var tables = document.getElementsByTagName('table');
    for (var i = 0; i < tables.length; i++) {
      tables[i].style.color = 'black';
    }
  }

  function sansStyle() {
    content.style.fontFamily = 'WorkSans';
  }
  function serifStyle() {
    content.style.fontFamily = 'Domine';
  }
</script></html>
